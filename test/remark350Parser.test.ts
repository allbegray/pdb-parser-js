import {Remark350Parser} from "../src/section/title";

test('REMARK 350 추출 매트릭스', () => {

    const pdb = `
REMARK 350 BIOMOLECULE: 1                                                                     
REMARK 350 APPLY THE FOLLOWING TO CHAINS: A                                     
REMARK 350   BIOMT1   1  1.000000  0.000000  0.000000        0.00000            
REMARK 350   BIOMT2   1  0.000000  1.000000  0.000000        0.00000            
REMARK 350   BIOMT3   1  0.000000  0.000000  1.000000        0.00000            
REMARK 350   BIOMT1   2  0.000000 -1.000000  0.000000        0.00000            
REMARK 350   BIOMT2   2 -1.000000  0.000000  0.000000        0.00000            
REMARK 350   BIOMT3   2  0.000000  0.000000 -1.000000      -77.63000            `

    const parser = new Remark350Parser()
    pdb.split('\n').forEach(line => {
        parser.collect(line)
    })
    const result = parser.parse()

    console.log(result)
});

test('REMARK 350 추출 simple', () => {

    const pdb = `
REMARK 350 BIOMOLECULE: 3 
REMARK 350 AUTHOR DETERMINED BIOLOGICAL UNIT: HEXAMERIC  
REMARK 350 APPLY THE FOLLOWING TO CHAINS: A, B, C, D, E, F, G, H, I,
REMARK 350                    AND CHAINS: J, K,  L
REMARK 350   BIOMT1   1  1.000000  0.000000  0.000000        0.00000
REMARK 350   BIOMT2   1  0.000000  1.000000  0.000000        0.00000
REMARK 350   BIOMT3   1  0.000000  0.000000  1.000000        0.00000`

    const parser = new Remark350Parser()
    pdb.split('\n').forEach(line => {
        parser.collect(line)
    })
    const result = parser.parse()

    console.log(result)
});

test('REMARK 350 추출', () => {

    const pdb = `
REMARK 350 COORDINATES FOR A COMPLETE MULTIMER REPRESENTING THE KNOWN 
REMARK 350 BIOLOGICALLY SIGNIFICANT OLIGOMERIZATION STATE OF THE 
REMARK 350 MOLECULE CAN BE GENERATED BY APPLYING BIOMT TRANSFORMATIONS 
REMARK 350 GIVEN BELOW. BOTH NON-CRYSTALLOGRAPHIC AND 
REMARK 350 CRYSTALLOGRAPHIC OPERATIONS ARE GIVEN. 
REMARK 350 
REMARK 350 BIOMOLECULE: 1 
REMARK 350 AUTHOR DETERMINED BIOLOGICAL UNIT: HEXAMERIC  
REMARK 350 APPLY THE FOLLOWING TO CHAINS: A, B, C, D, E, F  
REMARK 350   BIOMT1   1  1.000000  0.000000  0.000000        0.00000
REMARK 350   BIOMT2   1  0.000000  1.000000  0.000000        0.00000
REMARK 350   BIOMT3   1  0.000000  0.000000  1.000000        0.00000
REMARK 350
REMARK 350 BIOMOLECULE: 2
REMARK 350 AUTHOR DETERMINED BIOLOGICAL UNIT: HEXAMERIC 
REMARK 350 APPLY THE FOLLOWING TO CHAINS: G, H, I, J, K, L
REMARK 350   BIOMT1   1  1.000000  0.000000  0.000000        0.00000
REMARK 350   BIOMT2   1  0.000000  1.000000  0.000000        0.00000
REMARK 350   BIOMT3   1  0.000000  0.000000  1.000000        0.00000
REMARK 350
REMARK 350 BIOMOLECULE: 3 
REMARK 350 SOFTWARE DETERMINED QUATERNARY STRUCTURE: DODECAMERIC 
REMARK 350 SOFTWARE USED: PISA 
REMARK 350 TOTAL BURIED SURFACE AREA: 2990 ANGSTROM**2
REMARK 350 SURFACE AREA OF THE COMPLEX: 9330 ANGSTROM**2
REMARK 350 CHANGE IN SOLVENT FREE ENERGY: -40.0  KCAL/MOL 
REMARK 350 APPLY THE FOLLOWING TO CHAINS: A, B, C, D, E, F, G, H, I,
REMARK 350                    AND CHAINS: J, K,  L
REMARK 350   BIOMT1   1  1.000000  0.000000  0.000000        0.00000
REMARK 350   BIOMT2   1  0.000000  1.000000  0.000000        0.00000
REMARK 350   BIOMT3   1  0.000000  0.000000  1.000000        0.00000`

    const parser = new Remark350Parser()
    pdb.split('\n').forEach(line => {
        parser.collect(line)
    })
    const result = parser.parse()

    console.log(result)
});